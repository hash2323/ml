Implementing the K-means clustering algorithm to identify distinct clusters in a customer demographic dataset.

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.cluster import KMeans
import plotly as py

!pip install plotly

df = pd.read_csv('Mall_Customers.csv')


df.head()

df.shape

df.info()

df.describe()

df.isna().sum()

sns.pairplot(df, hue='Gender')

X = df[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']]

inertia = []

for n in range(1, 11):
    algorithm = (KMeans(n_clusters=n, init='k-means++',
                         n_init=10, random_state=111, algorithm='elkan'))
    algorithm.fit(X)
    inertia.append(algorithm.inertia_)

plt.figure(1, figsize=(15, 6))
plt.plot(np.arange(1, 11), inertia, 'o')
plt.plot(np.arange(1, 11), inertia, '-', alpha=0.5)
plt.xlabel('Number of Clusters')
plt.ylabel('Inertia')
plt.show()

algorithm = (KMeans(n_clusters=6, init='k-means++',
                    n_init=10, random_state=111, algorithm='elkan'))
algorithm.fit(X)

labels = algorithm.labels_
centroids = algorithm.cluster_centers_

y_kmeans = algorithm.fit_predict(X)

df['cluster'] = pd.DataFrame(y_kmeans)
df.head()

import plotly.graph_objs as go

trace1 = go.Scatter3d(
    x=df['Age'],
    y=df['Spending Score (1-100)'],
    z=df['Annual Income (k$)'],
    mode='markers',
    marker=dict(
        color=df['cluster'],
        size=10,
        line=dict(
            color=df['cluster'],
            width=12
        ),
        opacity=0.8
    )
)

data = [trace1]

layout = go.Layout(
    title='Clusters wrt Age, Income and Spending Scores',
    scene=dict(
        xaxis=dict(title='Age'),
        yaxis=dict(title='Spending Score'),
        zaxis=dict(title='Annual Income')
    )
)

fig = go.Figure(data=data, layout=layout)
py.offline.iplot(fig)
