import numpy as np
from sklearn.preprocessing import LabelEncoder
import pandas as pd
import nltk
import string
from sklearn import svm

df = pd.read_csv('/content/spam.xls')

df

encoder = LabelEncoder()
df['Label'] = encoder.fit_transform(df['Label'])

df.shape

from nltk.stem.porter import PorterStemmer
ps = PorterStemmer()

def get_importantFeatures(sent):
    sent = sent.lower()

    returnList = []
    sent = nltk.word_tokenize(sent)
    for i in sent:
        if i.isalnum():
            returnList.append(i)
    return returnList

def removing_stopWords(sent):
    returnList = []
    for i in sent:
        if i not in nltk.corpus.stopwords.words('english') and i not in string.punctuation:
            returnList.append(i)
    return returnList

def porter_stem(sent):
    returnList = []
    for i in sent:
        returnList.append(ps.stem(i))
    return " ".join(returnList)

nltk.download('punkt')
nltk.download('stopwords')
nltk.download('punkt_tab')

df['imp_feature'] = df['EmailText'].apply(get_importantFeatures)
df['imp_feature'] = df['imp_feature'].apply(removing_stopWords)
df['imp_feature'] = df['imp_feature'].apply(porter_stem)

df

from sklearn.model_selection import train_test_split
x = df['imp_feature']
y = df['Label']
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=42)

from sklearn.feature_extraction.text import TfidfVectorizer

tfidf = TfidfVectorizer()
feature = tfidf.fit_transform(x_train)
model = svm.SVC()
model.fit(feature, y_train)

y_predict = tfidf.transform(x_test)
print("Accuracy:", model.score(y_predict, y_test))



